- name: copy util folder to ec2 instance
  become: yes
  copy:
      src: /root/project/artifact.tar.gz
      dest: /home/ec2-user
      owner: ec2-user

- name: extract artifact.tar.gz into /home/ec2-user
  unarchive:
      src: /root/project/artifact.tar.gz
      dest: /home/ec2-user

- name: install npm
  shell:
      cmd: npm install
      chdir: /home/ec2-user/backend

- name: use pm2 to run backend
  become: yes
  shell: |
      cd /home/ec2-user/backend
      pm2 start npm -- start
